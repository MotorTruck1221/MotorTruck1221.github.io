<!DOCTYPE html><html  lang="en"><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Making an NGINX config for BYOD (Bring Your Own Domain) - MotorTruck1221</title>
<meta name="description" content="MotorTruck1221's personal website. And Blog.">
<meta name="format-detection" content="telephone=no">
<meta name="msapplication-TileColor" content="#000000">
<meta name="theme-color" content="#000000">
<meta property="og:image" content="https://motortruck1221.com/logo.png">
<meta name="twitter:image" content="https://motortruck1221.com/logo.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@motortruck1221">
<meta name="twitter:creator" content="@motortruck1221">
<meta property="og:title" content="MotorTruck1221">
<meta property="og:site_name" content="MotorTruck1221">
<meta property="og:description" content="MotorTruck1221's personal website. And Blog.">
<meta property="og:url" content="https://motortruck1221.com">
<meta property="og:type" content="website">
<link rel="icon" type="image/x-png" href="/logo.png">
<meta property="og:title" content="Making an NGINX config for BYOD (Bring Your Own Domain)">
<meta name="description" content="Why and how I made an NGINX config for BYOD">
<meta property="og:description" content="Why and how I made an NGINX config for BYOD">
<link rel="preload" as="fetch" crossorigin="anonymous" href="/blog/nginx-byod/_payload.json?66af6d4d-01bf-45b5-993f-539c58618e55">
<style>/*! tailwindcss v3.4.3 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:initial}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:initial;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:initial}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]{display:none}:root{--ctp-rosewater:242,213,207;--ctp-flamingo:238,190,190;--ctp-pink:244,184,228;--ctp-mauve:202,158,230;--ctp-red:231,130,132;--ctp-maroon:234,153,156;--ctp-peach:239,159,118;--ctp-yellow:229,200,144;--ctp-green:166,209,137;--ctp-teal:129,200,190;--ctp-sky:153,209,219;--ctp-sapphire:133,193,220;--ctp-blue:140,170,238;--ctp-lavender:186,187,241;--ctp-text:198,208,245;--ctp-subtext1:181,191,226;--ctp-subtext0:165,173,206;--ctp-overlay2:148,156,187;--ctp-overlay1:131,139,167;--ctp-overlay0:115,121,148;--ctp-surface2:98,104,128;--ctp-surface1:81,87,109;--ctp-surface0:65,69,89;--ctp-base:48,52,70;--ctp-mantle:41,44,60;--ctp-crust:35,38,52}*,::backdrop,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#3b82f680;--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }.container{width:100%}@media (min-width:640px){.container{max-width:640px}}@media (min-width:768px){.container{max-width:768px}}@media (min-width:1024px){.container{max-width:1024px}}@media (min-width:1280px){.container{max-width:1280px}}@media (min-width:1536px){.container{max-width:1536px}}.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em;margin-top:1.25em}.prose :where([class~=lead]):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-lead);font-size:1.25em;line-height:1.6;margin-bottom:1.2em;margin-top:1.2em}.prose :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-links);font-weight:500;text-decoration:underline}.prose :where(strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-bold);font-weight:600}.prose :where(a strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal;margin-bottom:1.25em;margin-top:1.25em;padding-inline-start:1.625em}.prose :where(ol[type=A]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=A s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-alpha}.prose :where(ol[type=a s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-alpha}.prose :where(ol[type=I]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type=I s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:upper-roman}.prose :where(ol[type=i s]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:lower-roman}.prose :where(ol[type="1"]):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){list-style-type:disc;margin-bottom:1.25em;margin-top:1.25em;padding-inline-start:1.625em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-counters);font-weight:400}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(dt):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;margin-top:1.25em}.prose :where(hr):not(:where([class~=not-prose],[class~=not-prose] *)){border-color:var(--tw-prose-hr);border-top-width:1px;margin-bottom:3em;margin-top:3em}.prose :where(blockquote):not(:where([class~=not-prose],[class~=not-prose] *)){border-inline-start-color:var(--tw-prose-quote-borders);border-inline-start-width:.25rem;color:var(--tw-prose-quotes);font-style:italic;font-weight:500;margin-bottom:1.6em;margin-top:1.6em;padding-inline-start:1em;quotes:"\201C""\201D""\2018""\2019"}.prose :where(blockquote p:first-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:open-quote}.prose :where(blockquote p:last-of-type):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:close-quote}.prose :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-size:2.25em;font-weight:800;line-height:1.1111111;margin-bottom:.8888889em;margin-top:0}.prose :where(h1 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:900}.prose :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-size:1.5em;font-weight:700;line-height:1.3333333;margin-bottom:1em;margin-top:2em}.prose :where(h2 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:800}.prose :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-size:1.25em;font-weight:600;line-height:1.6;margin-bottom:.6em;margin-top:1.6em}.prose :where(h3 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:700}.prose :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;line-height:1.5;margin-bottom:.5em;margin-top:1.5em}.prose :where(h4 strong):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-weight:700}.prose :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(picture):not(:where([class~=not-prose],[class~=not-prose] *)){display:block;margin-bottom:2em;margin-top:2em}.prose :where(video):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(kbd):not(:where([class~=not-prose],[class~=not-prose] *)){border-radius:.3125rem;box-shadow:0 0 0 1px rgb(var(--tw-prose-kbd-shadows)/10%),0 3px 0 rgb(var(--tw-prose-kbd-shadows)/10%);color:var(--tw-prose-kbd);font-family:inherit;font-size:.875em;font-weight:500;padding-inline-end:.375em;padding-bottom:.1875em;padding-top:.1875em;padding-inline-start:.375em}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-code);font-size:.875em;font-weight:600}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:"`"}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:"`"}.prose :where(a code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h1 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(h2 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.875em}.prose :where(h3 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit;font-size:.9em}.prose :where(h4 code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(blockquote code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(thead th code):not(:where([class~=not-prose],[class~=not-prose] *)){color:inherit}.prose :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){background-color:var(--tw-prose-pre-bg);border-radius:.375rem;color:var(--tw-prose-pre-code);font-size:.875em;font-weight:400;line-height:1.7142857;margin-bottom:1.7142857em;margin-top:1.7142857em;overflow-x:auto;padding-inline-end:1.1428571em;padding-bottom:.8571429em;padding-top:.8571429em;padding-inline-start:1.1428571em}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)){background-color:initial;border-radius:0;border-width:0;color:inherit;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;padding:0}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):before{content:none}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:none}.prose :where(table):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.875em;line-height:1.7142857;margin-bottom:2em;margin-top:2em;table-layout:auto;text-align:start;width:100%}.prose :where(thead):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-color:var(--tw-prose-th-borders);border-bottom-width:1px}.prose :where(thead th):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);font-weight:600;padding-inline-end:.5714286em;padding-bottom:.5714286em;padding-inline-start:.5714286em;vertical-align:bottom}.prose :where(tbody tr):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-color:var(--tw-prose-td-borders);border-bottom-width:1px}.prose :where(tbody tr:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){border-bottom-width:0}.prose :where(tbody td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:initial}.prose :where(tfoot):not(:where([class~=not-prose],[class~=not-prose] *)){border-top-color:var(--tw-prose-th-borders);border-top-width:1px}.prose :where(tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){vertical-align:top}.prose :where(figure>*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0;margin-top:0}.prose :where(figcaption):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-captions);font-size:.875em;line-height:1.4285714;margin-top:.8571429em}.prose{--tw-prose-body:#374151;--tw-prose-headings:#111827;--tw-prose-lead:#4b5563;--tw-prose-links:#111827;--tw-prose-bold:#111827;--tw-prose-counters:#6b7280;--tw-prose-bullets:#d1d5db;--tw-prose-hr:#e5e7eb;--tw-prose-quotes:#111827;--tw-prose-quote-borders:#e5e7eb;--tw-prose-captions:#6b7280;--tw-prose-kbd:#111827;--tw-prose-kbd-shadows:17 24 39;--tw-prose-code:#111827;--tw-prose-pre-code:#e5e7eb;--tw-prose-pre-bg:#1f2937;--tw-prose-th-borders:#d1d5db;--tw-prose-td-borders:#e5e7eb;--tw-prose-invert-body:#d1d5db;--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:#9ca3af;--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:#9ca3af;--tw-prose-invert-bullets:#4b5563;--tw-prose-invert-hr:#374151;--tw-prose-invert-quotes:#f3f4f6;--tw-prose-invert-quote-borders:#374151;--tw-prose-invert-captions:#9ca3af;--tw-prose-invert-kbd:#fff;--tw-prose-invert-kbd-shadows:255 255 255;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:#d1d5db;--tw-prose-invert-pre-bg:#00000080;--tw-prose-invert-th-borders:#4b5563;--tw-prose-invert-td-borders:#374151;font-size:1rem;line-height:1.75}.prose :where(picture>img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0;margin-top:0}.prose :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.5em;margin-top:.5em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.375em}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:.375em}.prose :where(.prose>ul>li p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.75em;margin-top:.75em}.prose :where(.prose>ul>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ul>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(.prose>ol>li>p:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ol>li>p:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.75em;margin-top:.75em}.prose :where(dl):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em;margin-top:1.25em}.prose :where(dd):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;padding-inline-start:1.625em}.prose :where(hr+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(thead th:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(thead th:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(tbody td,tfoot td):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:.5714286em;padding-bottom:.5714286em;padding-top:.5714286em;padding-inline-start:.5714286em}.prose :where(tbody td:first-child,tfoot td:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-start:0}.prose :where(tbody td:last-child,tfoot td:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){padding-inline-end:0}.prose :where(figure):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:2em;margin-top:2em}.prose :where(.prose>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(.prose>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}.prose-neutral{--tw-prose-body:#404040;--tw-prose-headings:#171717;--tw-prose-lead:#525252;--tw-prose-links:#171717;--tw-prose-bold:#171717;--tw-prose-counters:#737373;--tw-prose-bullets:#d4d4d4;--tw-prose-hr:#e5e5e5;--tw-prose-quotes:#171717;--tw-prose-quote-borders:#e5e5e5;--tw-prose-captions:#737373;--tw-prose-kbd:#171717;--tw-prose-kbd-shadows:23 23 23;--tw-prose-code:#171717;--tw-prose-pre-code:#e5e5e5;--tw-prose-pre-bg:#262626;--tw-prose-th-borders:#d4d4d4;--tw-prose-td-borders:#e5e5e5;--tw-prose-invert-body:#d4d4d4;--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:#a3a3a3;--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:#a3a3a3;--tw-prose-invert-bullets:#525252;--tw-prose-invert-hr:#404040;--tw-prose-invert-quotes:#f5f5f5;--tw-prose-invert-quote-borders:#404040;--tw-prose-invert-captions:#a3a3a3;--tw-prose-invert-kbd:#fff;--tw-prose-invert-kbd-shadows:255 255 255;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:#d4d4d4;--tw-prose-invert-pre-bg:#00000080;--tw-prose-invert-th-borders:#525252;--tw-prose-invert-td-borders:#404040}.absolute{position:absolute}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.mr-2{margin-right:.5rem}.mt-8{margin-top:2rem}.mt-auto{margin-top:auto}.block{display:block}.flex{display:flex}.hidden{display:none}.h-1\/2{height:50%}.h-12{height:3rem}.h-16{height:4rem}.h-20{height:5rem}.h-36{height:9rem}.h-96{height:24rem}.h-full{height:100%}.h-screen{height:100vh}.w-1{width:.25rem}.w-20{width:5rem}.w-80{width:20rem}.w-full{width:100%}.flex-1{flex:1 1 0%}.flex-shrink{flex-shrink:1}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-2{gap:.5rem}.gap-4{gap:1rem}.gap-8{gap:2rem}.overflow-hidden{overflow:hidden}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.text-ellipsis{text-overflow:ellipsis}.whitespace-nowrap{white-space:nowrap}.text-wrap{text-wrap:wrap}.break-words{overflow-wrap:break-word}.rounded-lg{border-radius:.5rem}.rounded-md{border-radius:.375rem}.border-2{border-width:2px}.border-cat-flamingo{--tw-border-opacity:1;border-color:rgba(var(--ctp-flamingo),var(--tw-border-opacity))}.border-cat-pink{--tw-border-opacity:1;border-color:rgba(var(--ctp-pink),var(--tw-border-opacity))}.border-cat-sapphire{--tw-border-opacity:1;border-color:rgba(var(--ctp-sapphire),var(--tw-border-opacity))}.bg-cat-base{--tw-bg-opacity:1;background-color:rgba(var(--ctp-base),var(--tw-bg-opacity))}.bg-cat-crust{--tw-bg-opacity:1;background-color:rgba(var(--ctp-crust),var(--tw-bg-opacity))}.bg-cat-overlay0{--tw-bg-opacity:1;background-color:rgba(var(--ctp-overlay0),var(--tw-bg-opacity))}.object-cover{object-fit:cover}.p-2{padding:.5rem}.p-4{padding:1rem}.pl-2{padding-left:.5rem}.pr-2{padding-right:.5rem}.pt-2{padding-top:.5rem}.text-center{text-align:center}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-lg{font-size:1.125rem}.text-lg,.text-xl{line-height:1.75rem}.text-xl{font-size:1.25rem}.font-bold{font-weight:700}.font-semibold{font-weight:600}.text-black{--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.text-cat-flamingo{--tw-text-opacity:1;color:rgba(var(--ctp-flamingo),var(--tw-text-opacity))}.text-cat-pink{--tw-text-opacity:1;color:rgba(var(--ctp-pink),var(--tw-text-opacity))}.text-cat-text{--tw-text-opacity:1;color:rgba(var(--ctp-text),var(--tw-text-opacity))}.underline{text-decoration-line:underline}.opacity-75{opacity:.75}.opacity-90{opacity:.9}.transition-all{transition-duration:.15s;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.hover\:scale-105:hover{--tw-scale-x:1.05;--tw-scale-y:1.05;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:border-cat-pink:hover{--tw-border-opacity:1;border-color:rgba(var(--ctp-pink),var(--tw-border-opacity))}.hover\:border-cat-sapphire:hover{--tw-border-opacity:1;border-color:rgba(var(--ctp-sapphire),var(--tw-border-opacity))}.hover\:bg-cat-flamingo:hover{--tw-bg-opacity:1;background-color:rgba(var(--ctp-flamingo),var(--tw-bg-opacity))}.hover\:bg-cat-pink:hover{--tw-bg-opacity:1;background-color:rgba(var(--ctp-pink),var(--tw-bg-opacity))}.hover\:text-cat-base:hover{--tw-text-opacity:1;color:rgba(var(--ctp-base),var(--tw-text-opacity))}.hover\:text-cat-crust:hover{--tw-text-opacity:1;color:rgba(var(--ctp-crust),var(--tw-text-opacity))}.hover\:text-cat-flamingo:hover{--tw-text-opacity:1;color:rgba(var(--ctp-flamingo),var(--tw-text-opacity))}.hover\:text-cat-sapphire:hover{--tw-text-opacity:1;color:rgba(var(--ctp-sapphire),var(--tw-text-opacity))}.active\:scale-100:active{--tw-scale-x:1;--tw-scale-y:1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@media (min-width:768px){.md\:block{display:block}.md\:flex{display:flex}.md\:w-1\/2{width:50%}.md\:gap-4{gap:1rem}.md\:text-lg{font-size:1.125rem;line-height:1.75rem}}</style>
<style>:host,:root{--fa-font-solid:normal 900 1em/1 "Font Awesome 6 Solid";--fa-font-regular:normal 400 1em/1 "Font Awesome 6 Regular";--fa-font-light:normal 300 1em/1 "Font Awesome 6 Light";--fa-font-thin:normal 100 1em/1 "Font Awesome 6 Thin";--fa-font-duotone:normal 900 1em/1 "Font Awesome 6 Duotone";--fa-font-sharp-solid:normal 900 1em/1 "Font Awesome 6 Sharp";--fa-font-sharp-regular:normal 400 1em/1 "Font Awesome 6 Sharp";--fa-font-sharp-light:normal 300 1em/1 "Font Awesome 6 Sharp";--fa-font-sharp-thin:normal 100 1em/1 "Font Awesome 6 Sharp";--fa-font-brands:normal 400 1em/1 "Font Awesome 6 Brands"}svg:not(:host).svg-inline--fa,svg:not(:root).svg-inline--fa{box-sizing:content-box;overflow:visible}.svg-inline--fa{display:var(--fa-display,inline-block);height:1em;overflow:visible;vertical-align:-.125em}.svg-inline--fa.fa-2xs{vertical-align:.1em}.svg-inline--fa.fa-xs{vertical-align:0}.svg-inline--fa.fa-sm{vertical-align:-.07143em}.svg-inline--fa.fa-lg{vertical-align:-.2em}.svg-inline--fa.fa-xl{vertical-align:-.25em}.svg-inline--fa.fa-2xl{vertical-align:-.3125em}.svg-inline--fa.fa-pull-left{margin-right:var(--fa-pull-margin,.3em);width:auto}.svg-inline--fa.fa-pull-right{margin-left:var(--fa-pull-margin,.3em);width:auto}.svg-inline--fa.fa-li{top:.25em;width:var(--fa-li-width,2em)}.svg-inline--fa.fa-fw{width:var(--fa-fw-width,1.25em)}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{transform-origin:center center}.fa-layers-text{left:50%;top:50%;transform:translate(-50%,-50%);transform-origin:center center}.fa-layers-counter{background-color:var(--fa-counter-background-color,#ff253a);border-radius:var(--fa-counter-border-radius,1em);box-sizing:border-box;color:var(--fa-inverse,#fff);line-height:var(--fa-counter-line-height,1);max-width:var(--fa-counter-max-width,5em);min-width:var(--fa-counter-min-width,1.5em);overflow:hidden;padding:var(--fa-counter-padding,.25em .5em);right:var(--fa-right,0);text-overflow:ellipsis;top:var(--fa-top,0);transform:scale(var(--fa-counter-scale,.25));transform-origin:top right}.fa-layers-bottom-right{bottom:var(--fa-bottom,0);right:var(--fa-right,0);top:auto;transform:scale(var(--fa-layers-scale,.25));transform-origin:bottom right}.fa-layers-bottom-left{bottom:var(--fa-bottom,0);left:var(--fa-left,0);right:auto;top:auto;transform:scale(var(--fa-layers-scale,.25));transform-origin:bottom left}.fa-layers-top-right{right:var(--fa-right,0);top:var(--fa-top,0);transform:scale(var(--fa-layers-scale,.25));transform-origin:top right}.fa-layers-top-left{left:var(--fa-left,0);right:auto;top:var(--fa-top,0);transform:scale(var(--fa-layers-scale,.25));transform-origin:top left}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-2xs{font-size:.625em;line-height:.1em;vertical-align:.225em}.fa-xs{font-size:.75em;line-height:.08333em;vertical-align:.125em}.fa-sm{font-size:.875em;line-height:.07143em;vertical-align:.05357em}.fa-lg{font-size:1.25em;line-height:.05em;vertical-align:-.075em}.fa-xl{font-size:1.5em;line-height:.04167em;vertical-align:-.125em}.fa-2xl{font-size:2em;line-height:.03125em;vertical-align:-.1875em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:var(--fa-li-margin,2.5em);padding-left:0}.fa-ul>li{position:relative}.fa-li{left:calc(var(--fa-li-width, 2em)*-1);line-height:inherit;position:absolute;text-align:center;width:var(--fa-li-width,2em)}.fa-border{border-color:var(--fa-border-color,#eee);border-radius:var(--fa-border-radius,.1em);border-style:var(--fa-border-style,solid);border-width:var(--fa-border-width,.08em);padding:var(--fa-border-padding,.2em .25em .15em)}.fa-pull-left{float:left;margin-right:var(--fa-pull-margin,.3em)}.fa-pull-right{float:right;margin-left:var(--fa-pull-margin,.3em)}.fa-beat{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-beat;animation-timing-function:var(--fa-animation-timing,ease-in-out)}.fa-bounce{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-bounce;animation-timing-function:var(--fa-animation-timing,cubic-bezier(.28,.84,.42,1))}.fa-fade{animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-fade;animation-timing-function:var(--fa-animation-timing,cubic-bezier(.4,0,.6,1))}.fa-beat-fade,.fa-fade{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s)}.fa-beat-fade{animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-beat-fade;animation-timing-function:var(--fa-animation-timing,cubic-bezier(.4,0,.6,1))}.fa-flip{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-flip;animation-timing-function:var(--fa-animation-timing,ease-in-out)}.fa-shake{animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-shake;animation-timing-function:var(--fa-animation-timing,linear)}.fa-shake,.fa-spin{animation-delay:var(--fa-animation-delay,0s);animation-direction:var(--fa-animation-direction,normal)}.fa-spin{animation-duration:var(--fa-animation-duration,2s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-spin;animation-timing-function:var(--fa-animation-timing,linear)}.fa-spin-reverse{--fa-animation-direction:reverse}.fa-pulse,.fa-spin-pulse{animation-direction:var(--fa-animation-direction,normal);animation-duration:var(--fa-animation-duration,1s);animation-iteration-count:var(--fa-animation-iteration-count,infinite);animation-name:fa-spin;animation-timing-function:var(--fa-animation-timing,steps(8))}@media (prefers-reduced-motion:reduce){.fa-beat,.fa-beat-fade,.fa-bounce,.fa-fade,.fa-flip,.fa-pulse,.fa-shake,.fa-spin,.fa-spin-pulse{animation-delay:-1ms;animation-duration:1ms;animation-iteration-count:1;transition-delay:0s;transition-duration:0s}}@keyframes fa-beat{0%,90%{transform:scale(1)}45%{transform:scale(var(--fa-beat-scale,1.25))}}@keyframes fa-bounce{0%{transform:scale(1) translateY(0)}10%{transform:scale(var(--fa-bounce-start-scale-x,1.1),var(--fa-bounce-start-scale-y,.9)) translateY(0)}30%{transform:scale(var(--fa-bounce-jump-scale-x,.9),var(--fa-bounce-jump-scale-y,1.1)) translateY(var(--fa-bounce-height,-.5em))}50%{transform:scale(var(--fa-bounce-land-scale-x,1.05),var(--fa-bounce-land-scale-y,.95)) translateY(0)}57%{transform:scale(1) translateY(var(--fa-bounce-rebound,-.125em))}64%{transform:scale(1) translateY(0)}to{transform:scale(1) translateY(0)}}@keyframes fa-fade{50%{opacity:var(--fa-fade-opacity,.4)}}@keyframes fa-beat-fade{0%,to{opacity:var(--fa-beat-fade-opacity,.4);transform:scale(1)}50%{opacity:1;transform:scale(var(--fa-beat-fade-scale,1.125))}}@keyframes fa-flip{50%{transform:rotate3d(var(--fa-flip-x,0),var(--fa-flip-y,1),var(--fa-flip-z,0),var(--fa-flip-angle,-180deg))}}@keyframes fa-shake{0%{transform:rotate(-15deg)}4%{transform:rotate(15deg)}24%,8%{transform:rotate(-18deg)}12%,28%{transform:rotate(18deg)}16%{transform:rotate(-22deg)}20%{transform:rotate(22deg)}32%{transform:rotate(-12deg)}36%{transform:rotate(12deg)}40%,to{transform:rotate(0deg)}}@keyframes fa-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.fa-rotate-90{transform:rotate(90deg)}.fa-rotate-180{transform:rotate(180deg)}.fa-rotate-270{transform:rotate(270deg)}.fa-flip-horizontal{transform:scaleX(-1)}.fa-flip-vertical{transform:scaleY(-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{transform:scale(-1)}.fa-rotate-by{transform:rotate(var(--fa-rotate-angle,0))}.fa-stack{display:inline-block;height:2em;position:relative;vertical-align:middle;width:2.5em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0;z-index:var(--fa-stack-z-index,auto)}.svg-inline--fa.fa-stack-1x{height:1em;width:1.25em}.svg-inline--fa.fa-stack-2x{height:2em;width:2.5em}.fa-inverse{color:var(--fa-inverse,#fff)}.fa-sr-only,.fa-sr-only-focusable:not(:focus),.sr-only,.sr-only-focusable:not(:focus){height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border-width:0;white-space:nowrap}.svg-inline--fa .fa-primary{fill:var(--fa-primary-color,currentColor);opacity:var(--fa-primary-opacity,1)}.svg-inline--fa .fa-secondary{fill:var(--fa-secondary-color,currentColor)}.svg-inline--fa .fa-secondary,.svg-inline--fa.fa-swap-opacity .fa-primary{opacity:var(--fa-secondary-opacity,.4)}.svg-inline--fa.fa-swap-opacity .fa-secondary{opacity:var(--fa-primary-opacity,1)}.svg-inline--fa mask .fa-primary,.svg-inline--fa mask .fa-secondary{fill:#000}.fa-duotone.fa-inverse,.fad.fa-inverse{color:var(--fa-inverse,#fff)}</style>
<style>pre code .line{display:block;min-height:1rem}</style>
<link rel="stylesheet" href="/_nuxt/default.BApXEc9X.css">
<link rel="stylesheet" href="/_nuxt/ProsePre.CchFRBtv.css">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BB8MzqFE.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/j8ijmn_z.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/f56yDaS0.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/qkzJTJS3.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BGtv2pXJ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CWyohxBu.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dd8IhghE.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C-v3KzvZ.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Dqw8r5Eh.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/RiJ59h12.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CIYqfwb0.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cr2C-0DX.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/AW1CQdhu.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/XfgRvOvc.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BMlXMZU6.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BFEKDv6K.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/9ch2zQj_.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/D5EmYH_W.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/t8Jy5Hzz.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DyUw7VDa.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C5MKI6tU.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BfE13Qgm.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DJWaQycY.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/_0Knjlwa.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CtGiXmdW.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/BMX9QL8C.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DJYUst0H.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Dmb2tNh7.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Xn3zZP58.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Cgebt4Ca.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/-_byLR0N.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/B6bJnLx8.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CVJ9ExAC.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/B5bs42de.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/BLyxLCxJ.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/BnGo-DAF.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/ChPUrzP9.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/BdUXD8Cl.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DIkO-_sS.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/XDZPpkf1.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CM9uZ9FI.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/d4-rYkLF.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DKLNBo7W.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/BWVhpDHp.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CtfmIWmM.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CAeIpQVE.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/BAM_5Rhd.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DEUZhM5c.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DbfCwQap.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CSbqp02V.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/t3Q-DLgb.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CkMp8RoB.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/D2HBmGan.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CkyqwLpy.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DA1vpcZb.js">
<script type="module" src="/_nuxt/BB8MzqFE.js" crossorigin></script></head><body><div id="__nuxt"><div class="flex flex-col h-screen"><div class="bg-cat-crust p-2 h-12 text-cat-text flex flex-row justify-between items-center"><a href="/" class="hidden md:block text-2xl font-bold">MotorTruck1221</a><div class="flex flex-row justify-right items-center gap-2 md:gap-4"><a href="/" class="text-md md:text-lg hover:text-cat-sapphire font-semibold">Home</a><a href="/projects" class="text-md md:text-lg hover:text-cat-sapphire font-semibold">Projects</a><a href="/blog" class="text-cat-pink text-md md:text-lg mr-2 hover:text-cat-sapphire font-semibold">Blog</a></div></div><div class="bg-cat-base flex-1"><span></span><main class="h-full w-full"><!--[--><div class="text-cat-text p-4 w-full h-full flex flex-row justify-left items-top"><div class="hidden md:flex flex-col h-full gap-4 justify-center items-center"><div class="h-1/2 border-2 border-cat-pink w-1"></div><a href="https://github.com/motortruck1221/" rel="noopener noreferrer" target="_blank" class="w-20 h-20 flex justify-center items-center text-4xl transition-all ease-in-out duration-300 hover:text-cat-flamingo"><svg class="svg-inline--fa fa-github" style="" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path class="" style="" fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="https://discord.com/users/818995901791207454" rel="noopener noreferrer" target="_blank" class="w-20 h-20 flex justify-center items-center text-4xl transition-all ease-in-out duration-300 hover:text-cat-flamingo"><svg class="svg-inline--fa fa-discord" style="" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="discord" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path class="" style="" fill="currentColor" d="M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"></path></svg></a><a href="https://twitter.com/motortruck1221" rel="noopener noreferrer" target="_blank" class="w-20 h-20 flex justify-center items-center text-4xl transition-all ease-in-out duration-300 hover:text-cat-flamingo"><svg class="svg-inline--fa fa-twitter" style="" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path class="" style="" fill="currentColor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"></path></svg></a><div class="h-1/2 border-2 border-cat-pink w-1"></div></div><div class="h-full w-full flex flex-col justify-center items-center"><div class="flex flex-col justify-left item-top h-full w-full bg-cat-overlay0 opacity-90 p-4 rounded-lg prose prose-neutral prose-md overflow-y-auto overflow-x-hidden text-wrap break-words text-black a"><!--[--><div><h1 id="making-an-nginx-config-for-byod-bring-your-own-domain"><!--[-->Making an NGINX config for BYOD (Bring Your Own Domain)<!--]--></h1><hr><h2 id="what-is-byod"><a href="#what-is-byod"><!--[-->What is BYOD?<!--]--></a></h2><p><!--[-->BYOD or Bring your own domain is an idea or concept that allows a user to point their domain to a servers IP allowing them to use the website from said domain.<!--]--></p><h2 id="the-challenges"><a href="#the-challenges"><!--[-->The challenges<!--]--></a></h2><ul><!--[--><li><!--[-->The server needs to throw a 403 if the domain is not in the list or database.<!--]--></li><li><!--[-->The server <em><!--[-->must<!--]--></em> generate a valid SSL certificate on the fly for the domain. Why? Because we don&#39;t want to have to manually generate certificates for every domain added.<!--]--></li><li><!--[-->It must be semi-easy to implement into already existing configurations.<!--]--></li><!--]--></ul><h2 id="but-why"><a href="#but-why"><!--[-->But why?<!--]--></a></h2><p><!--[-->I was asked if I had an idea of how to do it, and so I thought what the hell, let&#39;s give it a shot.
I don&#39;t mess with Nginx configurations that much, so I thought it would be a good learning experience.<!--]--></p><h2 id="the-solution"><a href="#the-solution"><!--[-->The solution<!--]--></a></h2><p><!--[-->First, I should specify that this uses <a href="https://openresty.org/en/" rel="nofollow"><!--[-->OpenResty<!--]--></a> which is a bundle of Nginx and LuaJIT. This is allows us to use Lua in our Nginx configuration.<!--]--></p><!--[--><pre class="language-nginx shiki shiki-themes catppuccin-mocha" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#CBA6F7">resolver </span><span style="--shiki-default:#FAB387">8.8.8.8</span><span style="--shiki-default:#CDD6F4"> ipv6=off</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="2"><span style="--shiki-default:#CBA6F7">lua_shared_dict</span><span style="--shiki-default:#CDD6F4"> acme </span><span style="--shiki-default:#FAB387">16m</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="3"><span style="--shiki-default:#CBA6F7">lua_ssl_trusted_certificate</span><span style="--shiki-default:#CDD6F4"> /etc/ssl/certs/ca-certificates.crt</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="4"><span style="--shiki-default:#CBA6F7">lua_ssl_verify_depth</span><span style="--shiki-default:#FAB387"> 2</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="5"><span style="--shiki-default:#CBA6F7">init_by_lua_block</span><span style="--shiki-default:#CDD6F4"> {
</span></span><span class="line" line="6"><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">    require</span><span style="--shiki-default:#CDD6F4">(</span><span style="--shiki-default:#A6E3A1">&quot;resty.acme.autossl&quot;</span><span style="--shiki-default:#CDD6F4">).</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">init</span><span style="--shiki-default:#CDD6F4">({
</span></span><span class="line" line="7"><span style="--shiki-default:#CDD6F4">        tos_accepted </span><span style="--shiki-default:#94E2D5">=</span><span style="--shiki-default:#F38BA8"> true</span><span style="--shiki-default:#CDD6F4">,
</span></span><span class="line" line="8"><span style="--shiki-default:#CDD6F4">        account_key_path </span><span style="--shiki-default:#94E2D5">=</span><span style="--shiki-default:#A6E3A1"> &quot;/etc/openresty/account.key&quot;</span><span style="--shiki-default:#CDD6F4">,
</span></span><span class="line" line="9"><span style="--shiki-default:#CDD6F4">        account_email </span><span style="--shiki-default:#94E2D5">=</span><span style="--shiki-default:#A6E3A1"> &quot;youremail@yourdomain.com&quot;</span><span style="--shiki-default:#CDD6F4">,
</span></span><span class="line" line="10"><span style="--shiki-default:#CDD6F4">        domain_whitelist </span><span style="--shiki-default:#94E2D5">=</span><span style="--shiki-default:#F38BA8"> nil</span><span style="--shiki-default:#CDD6F4">,
</span></span><span class="line" line="11"><span style="--shiki-default:#CDD6F4">        blocking </span><span style="--shiki-default:#94E2D5">=</span><span style="--shiki-default:#F38BA8"> true</span><span style="--shiki-default:#CDD6F4">,
</span></span><span class="line" line="12"><span style="--shiki-default:#6C7086;--shiki-default-font-style:italic">        -- remove in production
</span></span><span class="line" line="13"><span style="--shiki-default:#CDD6F4">        staging </span><span style="--shiki-default:#94E2D5">=</span><span style="--shiki-default:#F38BA8"> true</span><span style="--shiki-default:#CDD6F4">,
</span></span><span class="line" line="14"><span style="--shiki-default:#CDD6F4">    })
</span></span><span class="line" line="15"><span style="--shiki-default:#CDD6F4">}
</span></span><span class="line" line="16"><span emptylineplaceholder="true">
</span></span><span class="line" line="17"><span style="--shiki-default:#CBA6F7">init_worker_by_lua_block</span><span style="--shiki-default:#CDD6F4"> {
</span></span><span class="line" line="18"><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">    require</span><span style="--shiki-default:#CDD6F4">(</span><span style="--shiki-default:#A6E3A1">&quot;resty.acme.autossl&quot;</span><span style="--shiki-default:#CDD6F4">).</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">init_worker</span><span style="--shiki-default:#CDD6F4">()
</span></span><span class="line" line="19"><span style="--shiki-default:#CDD6F4">}
</span></span><span class="line" line="20"><span emptylineplaceholder="true">
</span></span><span class="line" line="21"><span style="--shiki-default:#CBA6F7">server</span><span style="--shiki-default:#CDD6F4"> {
</span></span><span class="line" line="22"><span style="--shiki-default:#6C7086;--shiki-default-font-style:italic">    #listen 80 default_server;
</span></span><span class="line" line="23"><span style="--shiki-default:#6C7086;--shiki-default-font-style:italic">    #listen [::]:80 default_server;
</span></span><span class="line" line="24"><span style="--shiki-default:#CBA6F7">    listen </span><span style="--shiki-default:#FAB387">443</span><span style="--shiki-default:#CDD6F4"> ssl</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="25"><span style="--shiki-default:#CBA6F7">    listen </span><span style="--shiki-default:#CDD6F4">[::]:443 ssl</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="26"><span style="--shiki-default:#CBA6F7">    server_name </span><span style="--shiki-default:#CDD6F4">yourmainserver.com</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="27"><span style="--shiki-default:#CBA6F7">    ssl_certificate </span><span style="--shiki-default:#CDD6F4">/etc/openresty/default.pem</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="28"><span style="--shiki-default:#CBA6F7">    ssl_certificate_key </span><span style="--shiki-default:#CDD6F4">/etc/openresty/default.key</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="29"><span style="--shiki-default:#CBA6F7">    ssl_certificate_by_lua_block</span><span style="--shiki-default:#CDD6F4"> {
</span></span><span class="line" line="30"><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">        require</span><span style="--shiki-default:#CDD6F4">(</span><span style="--shiki-default:#A6E3A1">&quot;resty.acme.autossl&quot;</span><span style="--shiki-default:#CDD6F4">).</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">ssl_certificate</span><span style="--shiki-default:#CDD6F4">()
</span></span><span class="line" line="31"><span style="--shiki-default:#CDD6F4">    } 
</span></span><span class="line" line="32"><span style="--shiki-default:#CBA6F7">    location</span><span style="--shiki-default:#CDD6F4"> / {
</span></span><span class="line" line="33"><span style="--shiki-default:#CBA6F7">        access_by_lua_block</span><span style="--shiki-default:#CDD6F4"> {
</span></span><span class="line" line="34"><span style="--shiki-default:#CBA6F7">            local</span><span style="--shiki-default:#CDD6F4"> res </span><span style="--shiki-default:#94E2D5">=</span><span style="--shiki-default:#CDD6F4"> ngx.location.</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">capture</span><span style="--shiki-default:#CDD6F4">(</span><span style="--shiki-default:#A6E3A1">&quot;/domainCheck/?domain=&quot; </span><span style="--shiki-default:#94E2D5">..</span><span style="--shiki-default:#CDD6F4"> ngx.</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">escape_uri</span><span style="--shiki-default:#CDD6F4">(ngx.var.host))
</span></span><span class="line" line="35"><span style="--shiki-default:#CBA6F7">            if</span><span style="--shiki-default:#CDD6F4"> res.status </span><span style="--shiki-default:#94E2D5">~=</span><span style="--shiki-default:#FAB387"> 200</span><span style="--shiki-default:#CBA6F7"> then
</span></span><span class="line" line="36"><span style="--shiki-default:#CDD6F4">                ngx.</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">log</span><span style="--shiki-default:#CDD6F4">(ngx.WARN, </span><span style="--shiki-default:#A6E3A1">&quot;Domain not allowed: &quot;</span><span style="--shiki-default:#CDD6F4">, ngx.var.host)
</span></span><span class="line" line="37"><span style="--shiki-default:#CBA6F7">                return</span><span style="--shiki-default:#CDD6F4"> ngx.</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">exit</span><span style="--shiki-default:#CDD6F4">(ngx.HTTP_FORBIDDEN)
</span></span><span class="line" line="38"><span style="--shiki-default:#CBA6F7">            end
</span></span><span class="line" line="39"><span style="--shiki-default:#CDD6F4">        }
</span></span><span class="line" line="40"><span style="--shiki-default:#CBA6F7">        proxy_set_header </span><span style="--shiki-default:#CDD6F4">Upgrade $http_upgrade</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="41"><span style="--shiki-default:#CBA6F7">        proxy_set_header </span><span style="--shiki-default:#CDD6F4">Connection </span><span style="--shiki-default:#A6E3A1">&#39;Upgrade&#39;</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="42"><span style="--shiki-default:#CBA6F7">        proxy_connect_timeout </span><span style="--shiki-default:#FAB387">10</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="43"><span style="--shiki-default:#CBA6F7">        proxy_send_timeout </span><span style="--shiki-default:#FAB387">90</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="44"><span style="--shiki-default:#CBA6F7">        proxy_read_timeout </span><span style="--shiki-default:#FAB387">90</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="45"><span style="--shiki-default:#CBA6F7">        proxy_buffer_size </span><span style="--shiki-default:#FAB387">128k</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="46"><span style="--shiki-default:#CBA6F7">        proxy_buffers </span><span style="--shiki-default:#FAB387">4</span><span style="--shiki-default:#FAB387"> 256k</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="47"><span style="--shiki-default:#CBA6F7">        proxy_busy_buffers_size </span><span style="--shiki-default:#FAB387">256k</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="48"><span style="--shiki-default:#CBA6F7">        proxy_temp_file_write_size </span><span style="--shiki-default:#FAB387">256k</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="49"><span style="--shiki-default:#CBA6F7">        proxy_pass </span><span style="--shiki-default:#CDD6F4">http://localhost:9292</span><span style="--shiki-default:#9399B2">;</span><span style="--shiki-default:#6C7086;--shiki-default-font-style:italic"> # Your actual website (ex: http://localhost:3000)
</span></span><span class="line" line="50"><span style="--shiki-default:#CDD6F4">    }
</span></span><span class="line" line="51"><span style="--shiki-default:#CBA6F7">    location</span><span style="--shiki-default:#CDD6F4"> /.well-known {
</span></span><span class="line" line="52"><span style="--shiki-default:#CBA6F7">        access_by_lua_block</span><span style="--shiki-default:#CDD6F4"> {
</span></span><span class="line" line="53"><span style="--shiki-default:#CBA6F7">            local</span><span style="--shiki-default:#CDD6F4"> res </span><span style="--shiki-default:#94E2D5">=</span><span style="--shiki-default:#CDD6F4"> ngx.location.</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">capture</span><span style="--shiki-default:#CDD6F4">(</span><span style="--shiki-default:#A6E3A1">&quot;/domainCheck/?domain=&quot; </span><span style="--shiki-default:#94E2D5">..</span><span style="--shiki-default:#CDD6F4"> ngx.</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">escape_uri</span><span style="--shiki-default:#CDD6F4">(ngx.var.host))
</span></span><span class="line" line="54"><span style="--shiki-default:#CBA6F7">            if</span><span style="--shiki-default:#CDD6F4"> res.status </span><span style="--shiki-default:#94E2D5">~=</span><span style="--shiki-default:#FAB387"> 200</span><span style="--shiki-default:#CBA6F7"> then
</span></span><span class="line" line="55"><span style="--shiki-default:#CDD6F4">                ngx.</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">log</span><span style="--shiki-default:#CDD6F4">(ngx.WARN, </span><span style="--shiki-default:#A6E3A1">&quot;Domain not allowed: &quot;</span><span style="--shiki-default:#CDD6F4">, ngx.var.host)
</span></span><span class="line" line="56"><span style="--shiki-default:#CBA6F7">                return</span><span style="--shiki-default:#CDD6F4"> ngx.</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">exit</span><span style="--shiki-default:#CDD6F4">(ngx.HTTP_FORBIDDEN)
</span></span><span class="line" line="57"><span style="--shiki-default:#CBA6F7">            end
</span></span><span class="line" line="58"><span style="--shiki-default:#CDD6F4">        }
</span></span><span class="line" line="59"><span style="--shiki-default:#CBA6F7">        content_by_lua_block</span><span style="--shiki-default:#CDD6F4"> {
</span></span><span class="line" line="60"><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">            require</span><span style="--shiki-default:#CDD6F4">(</span><span style="--shiki-default:#A6E3A1">&quot;resty.acme.autossl&quot;</span><span style="--shiki-default:#CDD6F4">).</span><span style="--shiki-default:#89B4FA;--shiki-default-font-style:italic">serve_http_challenge</span><span style="--shiki-default:#CDD6F4">()
</span></span><span class="line" line="61"><span style="--shiki-default:#CDD6F4">        }
</span></span><span class="line" line="62"><span style="--shiki-default:#CDD6F4">    }
</span></span><span class="line" line="63"><span style="--shiki-default:#CBA6F7">    location</span><span style="--shiki-default:#CDD6F4"> /domainCheck {
</span></span><span class="line" line="64"><span style="--shiki-default:#CBA6F7">        internal</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="65"><span style="--shiki-default:#CBA6F7">        proxy_pass </span><span style="--shiki-default:#CDD6F4">http://localhost:9292/domainCheck</span><span style="--shiki-default:#9399B2">;</span><span style="--shiki-default:#6C7086;--shiki-default-font-style:italic">  # Adjust the URL if needed
</span></span><span class="line" line="66"><span style="--shiki-default:#CBA6F7">        proxy_set_header </span><span style="--shiki-default:#CDD6F4">Host $host</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="67"><span style="--shiki-default:#CBA6F7">        proxy_set_header </span><span style="--shiki-default:#CDD6F4">X-Real-IP $remote_addr</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="68"><span style="--shiki-default:#CBA6F7">        proxy_set_header </span><span style="--shiki-default:#CDD6F4">X-Forwarded-For $proxy_add_x_forwarded_for</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="69"><span style="--shiki-default:#CBA6F7">        proxy_set_header </span><span style="--shiki-default:#CDD6F4">X-Forwarded-Proto $scheme</span><span style="--shiki-default:#9399B2">;
</span></span><span class="line" line="70"><span style="--shiki-default:#CDD6F4">    }
</span></span><span class="line" line="71"><span style="--shiki-default:#CDD6F4">}
</span></span></code><!--]--></pre><!--]--><h2 id="explanation"><a href="#explanation"><!--[-->Explanation<!--]--></a></h2><p><!--[-->This configuration is a bit complex, but I&#39;ll try to explain it as best as I can.<!--]--></p><ul><!--[--><li><!--[-->The following directives were copied and pasted from the <a href="https://github.com/fffonion/lua-resty-acme" rel="nofollow"><!--[-->lua-resty-acme repo<!--]--></a><ul><!--[--><li><!--[-->resolver: This is the DNS resolver used to resolve the domain.<!--]--></li><li><!--[-->lua_shared_dict: This is used to store the certificates.<!--]--></li><li><!--[-->lua_ssl_trusted_certificate: This is used to verify the Let&#39;s Encrypt API.<!--]--></li><li><!--[-->lua_ssl_verify_depth: This is used to verify the Let&#39;s Encrypt API.<!--]--></li><!--]--></ul><!--]--></li><li><!--[-->The <code class=""><!--[-->init_by_lua_block<!--]--></code> is used to initialize the Let&#39;s Encrypt API. This is where you can set the email, domain whitelist, and other settings.<ul><!--[--><li><!--[-->tos_accepted: This is used to accept the Let&#39;s Encrypt TOS.<!--]--></li><li><!--[-->account_key_path: This is the path to your account key.<!--]--></li><li><!--[-->account_email: This is the email used to register the account.<!--]--></li><li><!--[-->domain_whitelist: This is the list of domains that are allowed (set to nil as we will check this in the <code class=""><!--[-->location /<!--]--></code> block).<!--]--></li><li><!--[-->blocking: This is used to block the request until the certificate is generated. This could be set to false, but I felt like it was better to immediatley use the generated SSL certificate instead of using the fallbacks.<!--]--></li><li><!--[-->staging: This is used to use the Let&#39;s Encrypt staging API. This is useful for testing and should be removed in production.<!--]--></li><!--]--></ul><!--]--></li><li><!--[-->The <code class=""><!--[-->init_worker_by_lua_block<!--]--></code> is used to initialize the worker. This is where the certificate is generated.<!--]--></li><li><!--[-->The <code class=""><!--[-->server<!--]--></code> block is where the actual server configuration is. This is where the domain is checked and the ACME http challenge is served.<ul><!--[--><li><!--[-->The <code class=""><!--[-->listen<!--]--></code> directives are used to listen on port 443 and 80.<!--]--></li><li><!--[-->The <code class=""><!--[-->server_name<!--]--></code> directive is used to specify the main server name.<!--]--></li><li><!--[-->The <code class=""><!--[-->ssl_certificate<!--]--></code> and <code class=""><!--[-->ssl_certificate_key<!--]--></code> directives are used to specify the default certificate and key. This is used to serve the default certificate until the certificate is generated.<!--]--></li><li><!--[-->The <code class=""><!--[-->ssl_certificate_by_lua_block<!--]--></code> is used to generate the SSL certificate.<!--]--></li><li><!--[-->The <code class=""><!--[-->location /<!--]--></code> block is used to check if the domain is allowed. If it is not, it will return a 403.
<ul><!--[--><li><!--[-->The <code class=""><!--[-->access_by_lua_block<!--]--></code> is used to check if the domain is allowed.
<ol><!--[--><li><!--[-->We first capture the response from the <code class=""><!--[-->/domainCheck<!--]--></code> location.<!--]--></li><li><!--[-->If the status is not 200, we log a warning and return a 403.<!--]--></li><!--]--></ol><!--]--></li><!--]--></ul><!--]--></li><li><!--[-->The <code class=""><!--[-->location /domainCheck<!--]--></code> block is used to check if the domain is allowed.
<ul><!--[--><li><!--[-->The <code class=""><!--[-->internal<!--]--></code> directive is used to prevent direct access to the location.<!--]--></li><li><!--[-->The <code class=""><!--[-->proxy_pass<!--]--></code> directive is used to pass the request to our actual http server that verifies the domain against a database or list. If it is allowed, it sends a 200 status code.<!--]--></li><li><!--[-->The <code class=""><!--[-->proxy_set_header<!--]--></code> directives are used to set the headers.<!--]--></li><!--]--></ul><!--]--></li><li><!--[-->The <code class=""><!--[-->location /.well-known<!--]--></code> block is used to serve the ACME http challenge.
<ul><!--[--><li><!--[-->We also check if the domain is allowed here as to not spam the Let&#39;s Encrypt API.<!--]--></li><li><!--[-->The <code class=""><!--[-->content_by_lua_block<!--]--></code> is used to serve the ACME http challenge.<!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><h2 id="how-i-figured-it-out"><a href="#how-i-figured-it-out"><!--[-->How I figured it out<!--]--></a></h2><p><!--[-->I first started with the config provided by the <a href="https://docs.titaniumnetwork.org/guides/nginx" rel="nofollow"><!--[-->TitaniumNetwork Docs<!--]--></a>
Then I started looking at how to get the domain from the request and how to check if it was allowed.
I was using normal NGINX, but I quickly realized that I needed to use Lua to get the domain and check if it was allowed.
I then found the <a href="https://github.com/auto-ssl/lua-resty-auto-ssl/" rel="nofollow"><!--[-->lua-resty-auto-ssl repo<!--]--></a> but quickly realized it was unmaintained and kept searching.
Then I found the <a href="https://github.com/fffonion/lua-resty-acme" rel="nofollow"><!--[-->lua-resty-acme repo<!--]--></a> and started using that.
The rest was trial and error with a shit ton of Googling.<!--]--></p><h2 id="final-thoughts"><a href="#final-thoughts"><!--[-->Final thoughts<!--]--></a></h2><p><!--[-->This was a rather fun challenge, allowing me to learn crap tons of stuff about how NGINX and OpenResty works and had fun while doing so.
The repo providing a Discord bot, http server, database and this config is located <a href="https://github.com/ruby-network/byod-bot" rel="nofollow"><!--[-->here<!--]--></a><!--]--></p><h2 id="credits"><a href="#credits"><!--[-->Credits:<!--]--></a></h2><ul><!--[--><li><!--[--><a href="https://docs.titaniumnetwork.org" rel="nofollow"><!--[-->TitaniumNetwork Docs<!--]--></a> for the base config.<!--]--></li><li><!--[-->The <a href="https://github.com/fffonion/lua-resty-acme" rel="nofollow"><!--[-->lua resty acme repo<!--]--></a> for the auto ssl stuff.<!--]--></li><li><!--[-->The <a href="https://caddyserver.com/docs/automatic-https#on-demand-tls" rel="nofollow"><!--[-->On Demand TLS feature by Caddy<!--]--></a> which this was inspired by.<!--]--></li><!--]--></ul><style>html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!--]--><div class="h-16 w-full flex flex-row justify-between items-center gap-4 mt-auto"><a href="/blog" class="">Back</a></div></div></div></div><!--]--></main></div></div></div><div id="teleports"></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true" data-src="/blog/nginx-byod/_payload.json?66af6d4d-01bf-45b5-993f-539c58618e55">[{"state":1,"once":7,"_errors":9,"serverRendered":6,"path":12,"prerenderedAt":13},["Reactive",2],{"$ssite-config":3},{"env":4,"name":5,"trailingSlash":6},"production","MotorTruck1221",true,["Reactive",8],["Set"],["Reactive",10],{"content-query-uxqjqCxGNs":11},null,"/blog/nginx-byod",1714628683076]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1714628671022,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:"catppuccin-mocha",langs:["json","javascript","typescript","html","css","scss","bash","yaml","markdown","nginx","dockerfile"],highlighter:"shiki"},wsUrl:"",documentDriven:false,host:"",trailingSlash:false,search:"",contentHead:true,anchorLinks:{depth:4,exclude:[1]}}},app:{baseURL:"/",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script>
<script type="application/ld+json" id="schema-org-graph" data-hid="3437552">{"@context":"https://schema.org","@graph":[{"@id":"#website","@type":"WebSite","inLanguage":"en","name":"MotorTruck1221"},{"@id":"/blog/nginx-byod/#webpage","description":"Why and how I made an NGINX config for BYOD","name":"Making an NGINX config for BYOD (Bring Your Own Domain)","url":"/blog/nginx-byod/","@type":["WebPage","ProfilePage"],"isPartOf":{"@id":"#website"},"mainEntity":{"@type":"Person","name":"MotorTruck1221","additionalName":"MotorTruck","description":"Fullstack Developer","jobTitle":"Developer","image":"https://motortruck1221.com/logo.png","url":"https://motortruck1221.com","sameAs":["https://github.com/motortruck1221/","https://gitlab.com/motortruck1221/","https://twitter.com/motortruck1221/","https://discord.com/users/818995901791207454/"],"worksFor":[{"@type":"Organization","name":"Ruby Network","url":"https://ruby.rubynetwork.co"},{"@type":"Organization","name":"Nebula Services","url":"https://nebulaproxy.io"}],"isPartOf":[{"@type":"Website","name":"MotorTruck1221","url":"https://motortruck1221.com"},{"@type":"Organization","name":"Ruby Network","url":"https://ruby.rubynetwork.co"},{"@type":"Organization","name":"Nebula Services","url":"https://nebulaproxy.io"},{"@type":"Organization","name":"Mercury Workshop","url":"https://mercurywork.shop"}]},"potentialAction":[{"@type":"ReadAction","target":["/blog/nginx-byod/"]}]}]}</script></body></html>